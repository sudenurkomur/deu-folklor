{"version":3,"file":"server.js","names":["createElement","HELMET_ATTRIBUTE","TAG_NAMES","REACT_TAG_MAP","TAG_PROPERTIES","HTML_TAG_MAP","calcAggregatedState","flattenArray","propToAttr","jsx","_jsx","SELF_CLOSING_TAGS","NOSCRIPT","SCRIPT","STYLE","encodeSpecialCharacters","str","encode","replace","generateElementAttributesAsString","attrs","res","name","value","Object","entries","attr","neu","undefined","generateTitleAsString","title","attrsStr","flattenedTitle","generateTagsAsString","type","tags","tag","attributeHtml","INNER_HTML","CSS_TEXT","attrName","valStr","String","tagContent","innerHTML","cssText","isSelfClosing","includes","mapElementAttributesToProps","attributes","ops","addHelmetDataAttr","addKey","key","propName","dangerouslySetInnerHTML","__html","renderTitle","children","renderElement","renderElements","i","length","push","newServerState","heap","getState","state","helmets","base","toComponent","props","toString","s","bodyAttributes","htmlAttributes","link","links","meta","noscript","priority","script","style","titleAttributes"],"sources":["../../src/server.tsx"],"sourcesContent":["import {\n  type HTMLAttributes,\n  type Key,\n  type ReactNode,\n  createElement,\n} from 'react';\n\nimport {\n  HELMET_ATTRIBUTE,\n  TAG_NAMES,\n  REACT_TAG_MAP,\n  TAG_PROPERTIES,\n  HTML_TAG_MAP,\n} from './constants';\n\nimport type {\n  HelmetProviderHeap,\n  HelmetServerState,\n  ScriptProps,\n  StyleProps,\n  TitleProps,\n} from './types';\n\nimport {\n  calcAggregatedState,\n  flattenArray,\n  propToAttr,\n} from './utils';\n\nconst SELF_CLOSING_TAGS: string[] = [\n  TAG_NAMES.NOSCRIPT,\n  TAG_NAMES.SCRIPT,\n  TAG_NAMES.STYLE,\n];\n\nconst encodeSpecialCharacters = (str: string, encode = true) => {\n  if (!encode) return str;\n\n  return str.replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/\"/g, '&quot;')\n    .replace(/'/g, '&#x27;');\n};\n\nfunction generateElementAttributesAsString<T>(\n  attrs: HTMLAttributes<T>,\n): string {\n  let res: string = '';\n\n  for (const [name, value] of Object.entries(attrs)) {\n    const attr = propToAttr(name);\n    const neu = value === undefined ? attr : `${attr}=\"${value}\"`;\n    if (neu && res) res += ' ';\n    res += neu;\n  }\n\n  return res;\n}\n\nconst generateTitleAsString = (\n  title: string,\n  attrs: TitleProps,\n  encode: boolean,\n) => {\n  let attrsStr = generateElementAttributesAsString(attrs);\n  if (attrsStr) attrsStr = ` ${attrsStr}`;\n\n  const flattenedTitle = flattenArray(title);\n\n  return `<title ${HELMET_ATTRIBUTE}=\"true\"${attrsStr}>${\n    encodeSpecialCharacters(flattenedTitle, encode)\n  }</title>`;\n};\n\nfunction generateTagsAsString<T>(\n  type: string,\n  tags: Array<HTMLAttributes<T>>,\n  encode: boolean,\n): string {\n  let res = '';\n\n  for (const tag of tags) {\n    let attributeHtml = '';\n\n    const entries = Object.entries(tag);\n    for (const [name, value] of entries) {\n      if (!(name === TAG_PROPERTIES.INNER_HTML as string\n        || name === TAG_PROPERTIES.CSS_TEXT as string)) {\n        const attrName = HTML_TAG_MAP[name] ?? name;\n\n        let attr: string;\n        if (value === undefined) attr = attrName;\n        else {\n          // Perhaps, if `value` is not a string we should just do\n          // \"attr = attrName\", as in the case just above. Playing\n          // it safe now, to avoid changes from the original code.\n          const valStr = typeof value === 'string' ? value : String(value);\n          attr = `${attrName}=\"${encodeSpecialCharacters(valStr, encode)}\"`;\n        }\n\n        if (attributeHtml) attributeHtml += ` ${attr}`;\n        else attributeHtml = attr;\n      }\n    }\n\n    const tagContent = (tag as ScriptProps).innerHTML ?? (tag as StyleProps).cssText ?? '';\n\n    const isSelfClosing = !SELF_CLOSING_TAGS.includes(type);\n\n    res += `<${type} ${HELMET_ATTRIBUTE}=\"true\" ${attributeHtml}${\n      isSelfClosing ? '/>' : `>${tagContent}</${type}>`\n    }`;\n  }\n\n  return res;\n}\n\n/**\n * Given a map of element attribute names & values it returns the corresponding\n * map of element properties & values (i.e. replacing some attribute names by\n * their corresponding property names).\n */\n\nfunction mapElementAttributesToProps<T>(\n  attributes: HTMLAttributes<T>,\n  ops: { addHelmetDataAttr?: boolean; addKey?: Key } = {},\n): Record<string, unknown> {\n  const res: Record<string, unknown> = {};\n  if (ops.addHelmetDataAttr) res[HELMET_ATTRIBUTE] = true;\n  if (ops.addKey !== undefined) res.key = ops.addKey;\n  for (const [attrName, value] of Object.entries(attributes)) {\n    const propName = REACT_TAG_MAP[attrName] ?? attrName;\n\n    switch (propName) {\n      // cssText and innerHTML props get a special treatment to avoid that React\n      // escapes their values.\n      case 'cssText':\n      case 'innerHTML':\n        res.dangerouslySetInnerHTML = { __html: value as unknown };\n        break;\n      default:\n        res[propName] = value;\n    }\n  }\n  return res;\n}\n\nfunction renderTitle(title: string, attrs: TitleProps): ReactNode {\n  // NOTE: Rendered as array to match legacy behavior.\n  return [\n    <title\n      key={title}\n      // TODO: Can we avoid violating the rule?\n      // eslint-disable-next-line react/jsx-props-no-spreading\n      {...mapElementAttributesToProps(attrs, { addHelmetDataAttr: true })}\n    >\n      {title}\n    </title>,\n  ];\n}\n\nfunction renderElement<T>(\n  type: string,\n  attrs: HTMLAttributes<T>,\n  key?: Key,\n): ReactNode {\n  return createElement(type, mapElementAttributesToProps(attrs, {\n    addHelmetDataAttr: true,\n    addKey: key,\n  }));\n}\n\nfunction renderElements<T>(\n  type: string,\n  attrs: Array<HTMLAttributes<T>>,\n): ReactNode[] {\n  const res: ReactNode[] = [];\n  for (let i = 0; i < attrs.length; ++i) {\n    res.push(renderElement(type, attrs[i]!, i));\n  }\n  return res;\n}\n\nexport function newServerState(heap: HelmetProviderHeap): HelmetServerState {\n  // TODO: Should this function to be attached to the heap itself?\n  const getState = () => {\n    // eslint-disable-next-line no-param-reassign\n    heap.state ??= calcAggregatedState(heap.helmets);\n    return heap.state;\n  };\n\n  return {\n    base: {\n      toComponent() {\n        const props = getState().base;\n        return props ? renderElements('base', [props]) : [];\n      },\n      toString() {\n        const s = getState();\n        return s.base ? generateTagsAsString('base', [s.base], s.encodeSpecialCharacters) : '';\n      },\n    },\n    bodyAttributes: {\n      toComponent() {\n        const props = getState().bodyAttributes;\n        return mapElementAttributesToProps(props ?? {});\n      },\n      toString() {\n        const props = getState().bodyAttributes;\n        return generateElementAttributesAsString(props ?? {});\n      },\n    },\n    htmlAttributes: {\n      toComponent() {\n        const props = getState().htmlAttributes;\n        return mapElementAttributesToProps(props ?? {});\n      },\n      toString() {\n        const props = getState().htmlAttributes;\n        return generateElementAttributesAsString(props ?? {});\n      },\n    },\n    link: {\n      toComponent() {\n        return renderElements('link', getState().links ?? []);\n      },\n      toString() {\n        const s = getState();\n        return generateTagsAsString('link', s.links ?? [], s.encodeSpecialCharacters);\n      },\n    },\n    meta: {\n      toComponent() {\n        return renderElements('meta', getState().meta ?? []);\n      },\n      toString() {\n        const s = getState();\n        return generateTagsAsString('meta', s.meta ?? [], s.encodeSpecialCharacters);\n      },\n    },\n    noscript: {\n      toComponent() {\n        return renderElements('noscript', getState().noscript ?? []);\n      },\n      toString() {\n        const s = getState();\n        return generateTagsAsString('noscript', s.noscript ?? [], s.encodeSpecialCharacters);\n      },\n    },\n    priority: {\n      toComponent() {\n        const s = getState();\n        return [\n          ...renderElements('meta', s.priority?.meta ?? []),\n          ...renderElements('link', s.priority?.links ?? []),\n          ...renderElements('script', s.priority?.script ?? []),\n        ];\n      },\n      toString() {\n        const s = getState();\n        const meta = generateTagsAsString('meta', s.priority?.meta ?? [], s.encodeSpecialCharacters);\n        const link = generateTagsAsString('link', s.priority?.links ?? [], s.encodeSpecialCharacters);\n        const script = generateTagsAsString('script', s.priority?.script ?? [], s.encodeSpecialCharacters);\n\n        let res = meta;\n        if (link) {\n          if (res) res += ' ';\n          res += link;\n        }\n        if (script) {\n          if (res) res += ' ';\n          res += script;\n        }\n\n        return res;\n      },\n    },\n    script: {\n      toComponent() {\n        return renderElements('script', getState().script ?? []);\n      },\n      toString() {\n        const s = getState();\n        return generateTagsAsString('script', s.script ?? [], s.encodeSpecialCharacters);\n      },\n    },\n    style: {\n      toComponent() {\n        return renderElements('style', getState().style ?? []);\n      },\n      toString() {\n        const s = getState();\n        return generateTagsAsString('style', s.style ?? [], s.encodeSpecialCharacters);\n      },\n    },\n    title: {\n      toComponent(): ReactNode {\n        const s = getState();\n        return renderTitle(s.title ?? '', s.titleAttributes ?? {});\n      },\n      toString() {\n        const s = getState();\n        return generateTitleAsString(s.title ?? '', s.titleAttributes ?? {}, s.encodeSpecialCharacters);\n      },\n    },\n  };\n}\n"],"mappings":"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","ignoreList":[]}